import{c as K,i as T,e as q,t as p,u as J,a as f,w as _,j as G,z as X,h as D,g as Y,l as Z,A as U,_ as I,C as k,M as W,F as n,E as s,al as $,am as ee,J as S,K as V,R as F,D as te,U as L,an as ae,Q as oe,ao as re}from"./index-CkmlDq5s.js";import{Q as le}from"./QToolbar-Bxngc2Qx.js";import{Q as ie}from"./QResizeObserver-COOC36Sn.js";import{b as R}from"./managers-DDv6KUjV.js";import{Q as P}from"./QItemLabel-aXRmSGyF.js";import{Q as B,a as C}from"./QItem-C5ZHiONh.js";import{Q as z}from"./QSelect-BdO_8FQQ.js";import{c as O}from"./common-DE0SbnG8.js";import{u as j}from"./vue-i18n.runtime-CmCsUbpb.js";import{u as ne}from"./bluetooth-CDZPGnvR.js";import"./i18n-DDsdsaPU.js";import"./QChip-CRAwVKBI.js";import"./QMenu-1odQJaNg.js";import"./position-engine-D_l0NjWU.js";import"./selection-oP5RpDT_.js";import"./rtl-DFPa-2ov.js";import"./format-BvkBI9bc.js";const se=K({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(r,{slots:l,emit:h}){const{proxy:{$q:e}}=Y(),t=T(Z,q);if(t===q)return console.error("QFooter needs to be child of QLayout"),q;const u=p(parseInt(r.heightHint,10)),o=p(!0),c=p(J.value===!0||t.isContainer.value===!0?0:window.innerHeight),v=f(()=>r.reveal===!0||t.view.value.indexOf("F")!==-1||e.platform.is.ios&&t.isContainer.value===!0),g=f(()=>t.isContainer.value===!0?t.containerHeight.value:c.value),b=f(()=>{if(r.modelValue!==!0)return 0;if(v.value===!0)return o.value===!0?u.value:0;const a=t.scroll.value.position+g.value+u.value-t.height.value;return a>0?a:0}),x=f(()=>r.modelValue!==!0||v.value===!0&&o.value!==!0),y=f(()=>r.modelValue===!0&&x.value===!0&&r.reveal===!0),w=f(()=>"q-footer q-layout__section--marginal "+(v.value===!0?"fixed":"absolute")+"-bottom"+(r.bordered===!0?" q-footer--bordered":"")+(x.value===!0?" q-footer--hidden":"")+(r.modelValue!==!0?" q-layout--prevent-focus"+(v.value!==!0?" hidden":""):"")),M=f(()=>{const a=t.rows.value.bottom,m={};return a[0]==="l"&&t.left.space===!0&&(m[e.lang.rtl===!0?"right":"left"]=`${t.left.size}px`),a[2]==="r"&&t.right.space===!0&&(m[e.lang.rtl===!0?"left":"right"]=`${t.right.size}px`),m});function d(a,m){t.update("footer",a,m)}function i(a,m){a.value!==m&&(a.value=m)}function Q({height:a}){i(u,a),d("size",a)}function N(){if(r.reveal!==!0)return;const{direction:a,position:m,inflectionPoint:E}=t.scroll.value;i(o,a==="up"||m-E<100||t.height.value-g.value-m-u.value<300)}function A(a){y.value===!0&&i(o,!0),h("focusin",a)}_(()=>r.modelValue,a=>{d("space",a),i(o,!0),t.animate()}),_(b,a=>{d("offset",a)}),_(()=>r.reveal,a=>{a===!1&&i(o,r.modelValue)}),_(o,a=>{t.animate(),h("reveal",a)}),_([u,t.scroll,t.height],N),_(()=>e.screen.height,a=>{t.isContainer.value!==!0&&i(c,a)});const H={};return t.instances.footer=H,r.modelValue===!0&&d("size",u.value),d("space",r.modelValue),d("offset",b.value),G(()=>{t.instances.footer===H&&(t.instances.footer=void 0,d("size",0),d("offset",0),d("space",!1))}),()=>{const a=X(l.default,[D(ie,{debounce:0,onResize:Q})]);return r.elevated===!0&&a.push(D("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),D("footer",{class:w.value,style:M.value,onFocusin:A},a)}}}),ue=U({__name:"BluetoothSelectors",props:{mobile:{type:Boolean,default:!1},device:{},service:{},characteristic:{}},emits:["update:device","update:service","update:characteristic"],setup(r,{expose:l,emit:h}){l();const e=r,t=h,u=O(j(),"components.BluetoothSelectors."),o=f(()=>Array.from(R.deviceMap.values())),c=p([]),v=p([]),g=p(),b=f({get:()=>e.device,set:i=>t("update:device",i)}),x=f({get:()=>e.service,set:i=>t("update:service",i)}),y=f({get:()=>e.characteristic,set:i=>t("update:characteristic",i)}),w=async i=>{x.value=i,y.value=void 0,i?v.value=(await g.value?.listCharacteristics(i.uuid))?.filter(Q=>Q.properties.write)??[]:v.value=[],y.value=v.value[0]},d={props:e,emit:t,i18n:u,deviceList:o,serviceList:c,characteristicList:v,currentDeviceWrapper:g,currentDevice:b,currentService:x,currentCharacteristic:y,updateService:w,updateDevice:async i=>{g.value=i,b.value=i?.device,c.value=await i?.listPrimaryServices()??[],await w(c.value[0]),y.value=void 0}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}});function ce(r,l,h,e,t,u){return k(),W("div",{class:F(r.$q.screen.lt.md?"column q-gutter-y-sm":"row q-gutter-x-sm")},[n(z,{modelValue:e.currentDevice,"onUpdate:modelValue":[l[0]||(l[0]=o=>e.currentDevice=o),e.updateDevice],"display-value":e.currentDevice?.name??e.currentDevice?.id,label:e.i18n("labels.targetDevice"),options:e.deviceList,clearable:"",dense:"",outlined:"",style:{"min-width":"9rem"}},{option:s(({itemProps:o,opt:c})=>[n(B,$(ee(o)),{default:s(()=>[n(C,null,{default:s(()=>[n(P,null,{default:s(()=>[S(V(c.device.name),1)]),_:2},1024),n(P,{caption:""},{default:s(()=>[S(V(c.device.id),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":s(()=>[n(B,null,{default:s(()=>[n(C,{class:"text-italic text-grey"},{default:s(()=>[S(V(e.i18n("labels.noDevice")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","display-value","label","options"]),n(z,{modelValue:e.currentService,"onUpdate:modelValue":[l[1]||(l[1]=o=>e.currentService=o),e.updateService],label:e.i18n("labels.targetService"),options:e.serviceList,clearable:"",dense:"","option-label":"uuid","option-value":"uuid",outlined:"",style:{"min-width":"10rem"}},{"no-option":s(()=>[n(B,null,{default:s(()=>[n(C,{class:"text-italic text-grey"},{default:s(()=>[S(V(e.i18n("labels.noService")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","label","options"]),n(z,{modelValue:e.currentCharacteristic,"onUpdate:modelValue":l[2]||(l[2]=o=>e.currentCharacteristic=o),label:e.i18n("labels.targetCharacteristic"),options:e.characteristicList,clearable:"",dense:"","option-label":"uuid","option-value":"uuid",outlined:"",style:{"min-width":"12rem"}},{"no-option":s(()=>[n(B,null,{default:s(()=>[n(C,{class:"text-italic text-grey"},{default:s(()=>[S(V(e.i18n("labels.noCharacteristic")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","label","options"])],2)}const de=I(ue,[["render",ce],["__file","BluetoothSelectors.vue"]]),ve=U({__name:"BluetoothFooter",setup(r,{expose:l}){l();const{sendMessage:h}=ne(),e=p(),t=p(),u=p(),o=p(!1),c=p(""),v=O(j(),"layouts.footers.BluetoothFooter."),b={sendMessage:h,currentDevice:e,currentService:t,currentCharacteristic:u,isHex:o,payload:c,i18n:v,sendPayload:async()=>{e.value&&t.value&&u.value&&await h(e.value.id,t.value.uuid,u.value.uuid,c.value)},get bluetoothManager(){return R},BluetoothSelectors:de};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),me={class:"row q-gutter-x-sm"};function fe(r,l,h,e,t,u){return k(),te(se,{class:F(["q-pa-md",r.$q.dark.isActive?"bg-dark":"bg-grey-1"]),bordered:""},{default:s(()=>[n(le,null,{default:s(()=>[L("div",{class:F(r.$q.screen.lt.md?"column q-gutter-y-sm":"row q-gutter-x-sm")},[n(e.BluetoothSelectors,{device:e.currentDevice,"onUpdate:device":l[0]||(l[0]=o=>e.currentDevice=o),service:e.currentService,"onUpdate:service":l[1]||(l[1]=o=>e.currentService=o),characteristic:e.currentCharacteristic,"onUpdate:characteristic":l[2]||(l[2]=o=>e.currentCharacteristic=o)},null,8,["device","service","characteristic"]),L("div",me,[n(ae,{modelValue:e.payload,"onUpdate:modelValue":l[3]||(l[3]=o=>e.payload=o),disable:e.bluetoothManager.deviceMap.size===0,placeholder:e.i18n("labels.payload"),autogrow:"",clearable:"",dense:"",outlined:"",type:"text"},{after:s(()=>[n(oe,{color:e.isHex?"accent":"primary",disable:e.bluetoothManager.deviceMap.size===0,icon:"mdi-send",round:"",onClick:e.sendPayload},null,8,["color","disable"])]),_:1},8,["modelValue","disable","placeholder"]),n(re,{modelValue:e.isHex,"onUpdate:modelValue":l[4]||(l[4]=o=>e.isHex=o),disable:e.bluetoothManager.deviceMap.size===0,label:e.i18n("labels.hex")},null,8,["modelValue","disable","label"])])],2)]),_:1})]),_:1},8,["class"])}const Me=I(ve,[["render",fe],["__file","BluetoothFooter.vue"]]);export{Me as default};
